# JAPI

## Note
* Used to make `API` calls looking like `RPC` without too much boilerplate
* Every call is `POST` method
* `API` functions are autogenerated functions


## Getting started
```js
// Create API with prefix route and name (Global variable for javascript)
var j = japi.NewApi("/japi/", "JAPI")

// Register some handlers (Next section)

// Handle API calls here
http.Handle("POST /japi/{name}", j)

// Handle script itself
http.HandleFunc("GET /japi.js", j.HandleScript)
```


## Register Handlers
```go
// Let's create handler that will multiply each number by 2
j.Register("multiply", func(s string) (string, error) {
    var array = []int{}

    // Unmarshal JSON
    err := json.Unmarshal([]byte(s), &array)
    if err != nil {
        return "", errors.New("Fail to unmarshal JSON")
    }

    // Do multiplying
    for i, _ := range array {
        array[i] *= 2
    }

    // Marshal JSON back
    result, err := json.Marshal(array)
    if err != nil {
        return "", errors.New("Fail to serialize JSON")
    }
    return string(result), nil
})
```



## Call from `JavaScript`
* No need to write `JavaScript` bindings
```javascript
// Will return [20, 40, 60, 80]
await JAPI.multiply([10, 20, 30, 40]);
```